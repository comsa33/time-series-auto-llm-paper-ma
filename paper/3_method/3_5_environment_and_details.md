제 5 절 실험 환경 및 구현 세부 사항
(1) 하드웨어 및 소프트웨어 환경
본 연구에서 제안한 시계열 예측 자동화 시스템은 다음과 같은 실험 환경에서 구현 및 평가되었다.
1) 하드웨어 구성
실험에 사용된 하드웨어 환경은 다음과 같다.
-	프로세서: AMD Ryzen 7 3700X (8코어 16스레드, 최대 3.6GHz)
-	메모리: 62GB RAM
-	그래픽 가속기: NVIDIA GeForce RTX 3070 Ti (VRAM 8GB)
-	CUDA 환경: CUDA 12.2, 드라이버 버전 535.183.06
2) 소프트웨어 환경
소프트웨어 환경으로는 Ubuntu 22.04 LTS를 기반으로 하였으며, 다음과 같은 주요 프레임워크 및 라이브러리를 활용하였다.
-	프로그래밍 언어: Python 3.10
-	데이터 분석: pandas, numpy
-	시계열 분석: statsmodels, pmdarima
-	시계열 모델링: 
o	통계 기반: statsmodels (Exponential Smoothing), pmdarima (ARIMA)
o	하이브리드: Prophet
o	딥러닝 기반: TensorFlow 2.15.0 (LSTM, Transformer)
-	시각화: matplotlib, plotly, seaborn
-	고급 분석 기법: ruptures (변화점 탐지)
-	LLM 통합: OpenAI 호환 라이브러리
-	웹 인터페이스: Streamlit
(2) 시스템 아키텍처 설계
본 연구에서 개발한 시스템은 확장성과 유지보수성을 고려한 모듈식 아키텍처로 설계되었다. 하드웨어 리소스의 효율적 활용을 위해 각 모듈은 독립적으로 동작하도록 하였으며, 데이터 파이프라인과 모델 학습 과정에서 병렬 처리를 최대한 활용하였다.
1) 모델 추상화 설계
모든 시계열 모델은 객체지향 설계 원칙에 따라 공통 인터페이스를 통해 구현되었다. 각 모델은 학습, 예측, 성능 평가 등의 표준화된 메소드를 제공하며, 모델 생성은 디자인 패턴을 사용하여 사용자 또는 LLM이 지정한 매개변수에 따라 적합한 모델을 동적으로 생성할 수 있도록 하였다.
모델 복잡도(간단/중간/복잡)에 따라 하이퍼파라미터가 자동으로 조정되도록 설계하였다. 이는 LLM이 제안하는 모델 복잡도에 따라 적절한 기본값을 제공하기 위함이다.
2) LLM 연동 아키텍처
LLM을 하이퍼파라미터 튜닝 및 분석 도구로 활용하기 위해 다음과 같은 구조를 구현하였다.
1.	LLM 연결 모듈: 로컬 서버와 연결하여 Gemma3:27B 모델에 접근하는 기능을 담당하며, 호환 API를 사용하여 프롬프트 전송 및 응답 수신을 처리한다.
2.	프롬프트 템플릿 모듈: 모듈화된 프롬프트 템플릿을 활용하여 하이퍼파라미터 튜닝, 결과 분석, 보고서 생성 등 각 용도별 효과적인 LLM 쿼리를 생성한다.
3.	응답 처리 모듈: LLM의 구조화된 응답을 파싱하여 모델 파라미터로 변환하고, 제안된 하이퍼파라미터 값의 유효성을 검증하는 역할을 수행한다.
(3) 모델 구현 세부사항
다섯 가지 시계열 예측 모델의 세부 구현 특징은 다음과 같다.
1) ARIMA/SARIMA 모델
ARIMA 모델은 자기회귀 누적이동평균 모형으로, 시계열의 자기상관 구조를 모델링한다. 본 연구에서는 최적의 파라미터를 자동으로 탐색하는 기능과 사용자나 LLM이 지정한 파라미터(p, d, q, P, D, Q, m)를 직접 설정하는 기능을 모두 구현하였다.
모델 복잡도에 따른 주요 하이퍼파라미터 설정:
-	간단: 낮은 차수의 자기회귀 및 이동평균 항 사용
-	중간: 중간 차수의 자기회귀 및 이동평균 항, 기본적인 계절성 고려
-	복잡: 높은 차수의 자기회귀 및 이동평균 항, 복잡한 계절성 고려
ARIMA 모델은 데이터의 정상성 가정을 충족시키기 위해 차분 옵션을 제공하며, 자동 차분 검출 또는 수동 설정이 가능하도록 구현하였다.
2) 지수평활법 모델
지수평활법 모델은 다음 세 가지 변형을 지원하도록 구현하였다:
-	단순 지수평활법: 수준(level)만 고려
-	Holt 지수평활법: 수준과 추세(trend)를 고려
-	Holt-Winters 지수평활법: 수준, 추세, 계절성(seasonality)을 모두 고려
추세 및 계절성 요소는 가법(additive) 또는 승법(multiplicative) 모드로 설정할 수 있으며, Box-Cox 변환을 지원하여 비선형 패턴이 있는 데이터의 성능을 향상시킬 수 있도록 하였다.
3) Prophet 모델
Prophet 모델은 Facebook에서 개발한 시계열 예측 라이브러리를 활용하여 구현하였다. 이 모델은 추세와 계절성을 분리하여 모델링하는 특징이 있으며, 일별, 주별, 연별 계절성을 동시에 고려할 수 있도록 구현하였다.
주요 하이퍼파라미터로는 변화점 민감도, 계절성 강도, 계절성 모드(가법/승법), 변화점 탐지 범위 등이 있다. 복잡도에 따라 계절성 고려 범위를 조정하였으며, 특히 일별 주기성이 뚜렷한 PM2.5 데이터의 특성을 반영하였다.
4) LSTM 모델
LSTM 모델은 TensorFlow/Keras 프레임워크를 사용하여 구현하였다. 이 모델은 순환 신경망 구조를 활용하여 시계열의 시간적 의존성을 포착하는 특징이 있다.
주요 하이퍼파라미터로는 입력 시퀀스 길이, LSTM 층의 유닛 수, 드롭아웃 비율, 학습 에폭 수, 배치 크기, 학습률 등이 있다. 복잡도에 따라 네트워크 깊이와 너비가 자동으로 조정되도록 구현하였으며, 과적합 방지를 위한 조기 종료 메커니즘을 적용하였다.
5) Transformer 모델
Transformer 모델은 TensorFlow를 기반으로 구현하였다. 이 모델은 멀티헤드 셀프 어텐션 메커니즘을 활용하여 시계열 데이터의 장거리 의존성을 포착하는 특징이 있다.
주요 하이퍼파라미터로는 임베딩 차원, 어텐션 헤드 수, 인코더 레이어 수, 피드포워드 네트워크 차원, 드롭아웃 비율, 학습률 등이 있다. 복잡도에 따라 모델 규모와 어텐션 헤드 수가 조정되도록 구현하였다.
(4) 데이터 처리 파이프라인
본 연구에서는 시계열 데이터의 특성을 고려한 전처리 파이프라인을 구현하였다. 핵심 처리 단계는 다음과 같다.
1) 데이터 수집
서울시 대기질 OpenAPI를 통해 시간대별 측정 데이터를 수집하였다. 시작일과 종료일 사이의 데이터를 요청하고, 응답을 데이터프레임으로 변환하는 과정을 자동화하였다. 수집 과정에서 발생할 수 있는 네트워크 오류나 API 제한에 대응하는 로직을 포함하였다.
2) 데이터 전처리
수집된 데이터는 다음과 같은 전처리 단계를 거쳤다:
1.	시간 인덱스 변환: 시간 정보를 datetime 형식으로 변환하고 시계열 인덱스로 설정
2.	결측치 처리: 시간 기반 보간법을 사용하여 결측치 보간
3.	이상치 탐지 및 처리: 통계적 방법으로 이상치 탐지, 필요시 처리
4.	시계열 분할: 시간순으로 훈련/테스트 세트 분리 (80%/20% 비율 적용)
5.	특성 스케일링: 정규화 적용으로 모델 학습 안정화
3) 시계열 변환 및 분석
모델 학습 전에 시계열 데이터에 대한 추가 분석 및 변환을 수행하였다:
1.	정상성 검정: ADF 및 KPSS 테스트를 통해 시계열의 정상성 검정
2.	시계열 분해: 추세, 계절성, 잔차 컴포넌트로 분해
3.	차분 적용: 필요시 차분을 적용하여 정상성 확보
4.	변화점 탐지: 시계열 변화점 분석으로 구조적 변화 포착
(5) LLM 활용 자동화 구현
생성형 인공지능 기반의 자동화 구현을 위해 LLM을 다음과 같이 활용하였다.
1) 하이퍼파라미터 최적화 프로세스
하이퍼파라미터 최적화는 다음과 같은 반복적 프로세스로 구현되었다:
1.	상태 표현: 현재 모델 성능과 하이퍼파라미터를 구조화된 형식으로 표현
2.	프롬프트 생성: 성능 지표와 데이터 특성을 포함한 프롬프트 생성
3.	LLM 추론: 프롬프트에 대한 LLM의 응답 수신
4.	파라미터 추출: 응답에서 제안된 하이퍼파라미터와 근거 추출
5.	모델 재학습: 새 파라미터로 모델 재학습 및 성능 평가
6.	피드백 루프: 성능 향상 시 파라미터 유지, 그렇지 않으면 복원
이 프로세스는 사용자에 의해 임의 횟수만큼 반복할 수 있도록 설계하였으며, 각 단계의 정보는 로깅되어 실험의 재현성을 보장하였다.
2) 분석 보고서 자동 생성
LLM을 이용한 분석 보고서 생성 프로세스는 다음과 같이 구현되었다:
1.	데이터 종합: 모든 모델의 성능 지표와 예측 결과 수집
2.	컨텍스트 구성: 보고서 생성에 필요한 정보 구조화
3.	보고서 요청: 구조화된 분석 보고서 생성 요청
4.	문서화 변환: 생성된 응답을 형식화된 보고서로 변환
(6) 사용자 인터페이스 구현
연구의 응용 가능성을 검증하기 위해 웹 기반 인터페이스를 구현하였다. 이 인터페이스는 다음과 같은 주요 기능을 제공한다:
1.	데이터 탐색: 데이터 업로드, 기본 통계량 확인, 시계열 시각화
2.	시계열 분석: 정상성 검정, 계절성 분석, 변화점 탐지
3.	모델 훈련: 모델 선택, 하이퍼파라미터 설정, 학습 실행
4.	LLM 튜닝: 모델 자동 튜닝, 성능 비교
5.	결과 보고: 자동 생성된 분석 보고서 표시
(7) 재현성 및 신뢰성 확보 방안
실험의 재현성과 신뢰성을 보장하기 위해 다음과 같은 방안을 적용하였다:
1.	랜덤 시드 고정: 모든 실험에서 난수 시드를 고정하여 결과의 일관성 확보
2.	버전 관리: 사용된 모든 라이브러리의 버전 명시
3.	로깅 시스템: 실험 단계와 모델 학습 과정의 상세한 기록
4.	A/B 테스트: LLM 제안 적용 모델과 기본 모델의 객관적 성능 비교
이러한 방안을 통해 본 연구 결과의 신뢰성과 재현성을 확보하였으며, 향후 다른 연구자들이 유사한 접근 방식을 시도할 때 참고할 수 있는 기초를 마련하였다.
